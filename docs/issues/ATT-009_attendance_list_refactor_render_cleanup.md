# [ATT-009] attendance_list リファクタ: `render` 周辺の整理（責務の明確化）

ステータス: Done
作成日: 2025-12-13
更新日: 2025-12-14
担当: 未割当
関連: `attendance_list.html`

## 背景 / 課題

- `render()` 自体は段階的にヘルパ化されているが、今後の変更が入りやすい。
- `render` は「DOM構築」「ハイライト展開」「スクロール復元」を持ち、仕様追加で再肥大化しやすい。

## 目的

- `render()` を「全体の流れが上から読める薄いオーケストレータ」に留め、再肥大化を防ぐ。
- `renderRows(dayList, listLabel) => Map` を中心に、責務を固定化する。

## スコープ

- フロントのみ: `attendance_list.html`

## 非スコープ

- 仮想スクロール等のUX/性能機能追加
- CSS/UI変更

## 提案アプローチ

- `render()` の責務を以下に固定:
  - 初期化（list clear）
  - `renderRows(...)` 呼び出し
  - 後処理（highlight展開/スクロール復元）
- 行生成は `buildRecordRowElement` 配下に閉じ込める。
- 将来的に「月境界処理」などが増える場合でも `renderRows` の内部に集約。

## 受け入れ基準（Acceptance Criteria）

- 既存のフィルタ、月ヘッダ、ラベル位置、行クリック、ハイライト自動展開が同じ。
- `render()` が再度巨大化しない（追加はヘルパ側へ）。

## 実装ステップ

1. `render` に新規分岐が増えたら、必ずヘルパへ移す（運用ルール）
2. 可能なら `renderRows` を単体で読める形に整える（引数は最小）

## 影響 / リスク

- 小さすぎる関数分割は逆に可読性を落とす → 「まとまった責務」単位でのみ抽出する。
